### Problem Statement ###

According to the [U. S. Department of Transportation](https://ops.fhwa.dot.gov/weather/q1_roadimpact.htm), 4% of vehicle crashes in the US are snow-related.  This is quite a significant number, especially considering that snow is seasonal and only common in certain parts of the country.

In this project, neural nets are trained that are capable of automatically detecting falling snow in images.  The ultimate goal is to use neural nets such as these to automatically detect falling snow in live webcam feeds.  This work could be of particular interest to:
- Emergency and transportation personnel, who can use automated snowfall detection to monitor weather conditions on a highly localized level.
- Navigation apps, which can give notifications of weather ahead.
- Ski resorts, which can easily monitor new snowfall on individual ski runs.

### Executive Summary ###

In this project, a Tensorflow pipeline is built that is capable of training convolutional neural nets using 100,000 images with or without falling snow.  See below for details on the source of the data.  The process is carried out on a personal computer with a CUDA-enabled GPU.  The models are evaluated according to precision, recall, f1 score, and accuracy.  Multiple snow classification thresholds are considered to optimize and tune the model to maximize the desired metric.  Finally, a streamlit app is built that can run locally and use one of the saved models to predict whether an uploaded image has falling snow.

This is a field with some existing work. [This paper](https://ieeexplore.ieee.org/document/9119079) and [this company](http://vizzion.com/road-conditions.html) are particularly relevant.  Other related work includes [removal of snow from images](https://sites.google.com/view/yunfuliu/desnownet) and [object detection in poor weather](https://www.kaggle.com/aalborguniversity/aau-rainsnow). The focus here is on identification of snow in images, with removal of snow from those images as a possible future direction.

### Structure of this Repo ###

README.md

LICENSE

Presentation Slides

saved_models:
- test1 and model2: The saved models.
- test1_hist and model2_hist: The training histories of the models saved in .json format.
- csv files: True and predicted labels generated by each model for the images in the dataset.  1 means snow and 0 means clear.

code folder:
- part1_snowdetect_firstfit.ipynb: Preprocessing of images and training of first model.  Model is saved, reloaded, and used to make a prediction on a single image.
- part2_snowdetect_modeltuning.ipynb: A second model is trained.  Classification metrics for both models are examined with different cutoff values for snow classification.  A model is chosen for streamlit deployment, and future directions are discussed.
- presentation_visuals.ipynb: Some figures are recreated and altered to be more suitable for a presentation.
- metricstools.py: A script that contains a function used to check the classification metrics of each model based on generated predictions.
- streamlit.py: A script used to run a streamlit app locally. The app uses the saved model2 to predict whether an uploaded image has falling snow.

data folder:
- The dataset is too large to include here.  Please see below for instructions on where to find it and how to include it so it works with the code in this repo.

### Source and Structure of the Data ###

The data can be found [here](https://sites.google.com/view/yunfuliu/desnownet).  Due to the large overall size of the dataset, the images are not included in this repo.  To import the images and properly assign labels, they should be located at the following paths relative to the Jupyter notebooks:
- ../data/train/clear/
- ../data/train/snow/

At the above website, click the link "Training set."  Save the ground truth (gt) images in the clear folder and the synthetic images in the snow folder.

### Data Exploration ###

### Classficiation ###

### Conclusions and Recommendations ###

